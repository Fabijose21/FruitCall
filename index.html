<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FruitCall</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;
            display: flex;
            height: 100vh;
            overflow: hidden;
            transition: background-color 0.3s;
        }
        body.dark {
            background-color: #111b21;
            color: #e9edef;
        }
        body.light {
            background-color: #f0f2f5;
            color: #111b21;
        }
        .sidebar {
            width: 130px;
            border-right: 1px solid;
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
        }
        .sidebar.hidden {
            margin-left: -130px;
        }
        .dark .sidebar {
            background-color: #111b21;
            border-right-color: #2a3942;
        }
        .light .sidebar {
            background-color: #fff;
            border-right-color: #e9edef;
        }
        .sidebar-header {
            padding: 6px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 35px;
            transition: background-color 0.3s;
        }
        .dark .sidebar-header {
            background-color: #202c33;
        }
        .light .sidebar-header {
            background-color: #008069;
        }
        .sidebar-title {
            font-size: 12px;
            font-weight: 500;
        }
        .dark .sidebar-title {
            color: #e9edef;
        }
        .light .sidebar-title {
            color: #fff;
        }
        .header-icons {
            display: flex;
            gap: 8px;
        }
        .header-icon {
            background: none;
            border: none;
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: background 0.2s, color 0.3s;
        }
        .dark .header-icon {
            color: #aebac1;
        }
        .light .header-icon {
            color: #fff;
        }
        .dark .header-icon:hover {
            background-color: #2a3942;
        }
        .light .header-icon:hover {
            background-color: #017561;
        }
        .search-container {
            padding: 4px 6px;
            transition: background-color 0.3s;
        }
        .dark .search-container {
            background-color: #202c33;
        }
        .light .search-container {
            background-color: #fff;
        }
        .search-box {
            border: none;
            border-radius: 5px;
            padding: 4px 6px;
            width: 100%;
            font-size: 9px;
            outline: none;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark .search-box {
            background-color: #111b21;
            color: #e9edef;
        }
        .light .search-box {
            background-color: #f0f2f5;
            color: #3b4a54;
        }
        .dark .search-box::placeholder {
            color: #667781;
        }
        .light .search-box::placeholder {
            color: #667781;
        }
        .contacts-list {
            flex: 1;
            overflow-y: auto;
            transition: background-color 0.3s;
        }
        .dark .contacts-list {
            background-color: #111b21;
        }
        .light .contacts-list {
            background-color: #fff;
        }
        .contact {
            padding: 6px 8px;
            border-bottom: 1px solid;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background 0.2s, border-color 0.3s;
        }
        .dark .contact {
            border-bottom-color: #2a3942;
        }
        .light .contact {
            border-bottom-color: #e9edef;
        }
        .dark .contact:hover {
            background-color: #202c33;
        }
        .light .contact:hover {
            background-color: #f5f6f6;
        }
        .dark .contact.active {
            background-color: #2a3942;
        }
        .light .contact.active {
            background-color: #e9edef;
        }
        .contact-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin-right: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
            transition: background-color 0.3s;
        }
        .dark .contact-avatar {
            background-color: #6b7c85;
        }
        .light .contact-avatar {
            background-color: #dfe5e7;
        }
        .contact-info {
            flex: 1;
            min-width: 0;
        }
        .contact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }
        .contact-name {
            font-size: 10px;
            font-weight: 400;
            transition: color 0.3s;
        }
        .dark .contact-name {
            color: #e9edef;
        }
        .light .contact-name {
            color: #111b21;
        }
        .contact-time {
            font-size: 8px;
            color: #667781;
        }
        .contact-message {
            font-size: 8px;
            color: #667781;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s;
        }
        .dark .chat-section {
            background-color: #0b141a;
        }
        .light .chat-section {
            background-color: #efeae2;
        }
        .chat-header {
            padding: 6px 10px;
            display: flex;
            align-items: center;
            height: 35px;
            border-left: 1px solid;
            justify-content: space-between;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .dark .chat-header {
            background-color: #202c33;
            border-left-color: #2a3942;
        }
        .light .chat-header {
            background-color: #f0f2f5;
            border-left-color: #e9edef;
        }
        .chat-header-left {
            display: flex;
            align-items: center;
            flex: 1;
        }
        .menu-toggle {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            margin-right: 8px;
            border-radius: 50%;
            transition: background 0.2s, color 0.3s;
        }
        .dark .menu-toggle {
            color: #aebac1;
        }
        .light .menu-toggle {
            color: #54656f;
        }
        .dark .menu-toggle:hover {
            background-color: #2a3942;
        }
        .light .menu-toggle:hover {
            background-color: #e9edef;
        }
        .chat-header-avatar {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .dark .chat-header-avatar {
            background-color: #6b7c85;
        }
        .light .chat-header-avatar {
            background-color: #dfe5e7;
        }
        .chat-header-info {
            flex: 1;
        }
        .chat-header-name {
            font-size: 11px;
            transition: color 0.3s;
        }
        .dark .chat-header-name {
            color: #e9edef;
        }
        .light .chat-header-name {
            color: #111b21;
        }
        .chat-header-status {
            font-size: 9px;
            color: #667781;
        }
        .theme-toggle {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: background 0.2s;
        }
        .dark .theme-toggle {
            color: #aebac1;
        }
        .light .theme-toggle {
            color: #54656f;
        }
        .dark .theme-toggle:hover {
            background-color: #2a3942;
        }
        .light .theme-toggle:hover {
            background-color: #e9edef;
        }
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 12px 20px;
            transition: background-color 0.3s;
        }
        .dark .chat-container {
            background-color: #0b141a;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABnSURBVHja7M4xDQAwDMCwdv/QKRyBKxmILjqi+3pAAAAAAAAAAAAAAAAA+A9YvQOuvgJXPwKrn8HVz+Dqd3D1O7j6HVz9Dq5+B1e/g6vfwdXv4Op3cPU7uPodXP0Orn4AAACAbwE4VAMAtqZkSgAAAABJRU5ErkJggg==');
            background-size: 300px;
        }
        .light .chat-container {
            background-color: #efeae2;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABnSURBVHja7M4xDQAwDMCwdv/QKRyBKxmILjqi+3pAAAAAAAAAAAAAAAAA+A9YvQOuvgJXPwKrn8HVz+Dqd3D1O7j6HVz9Dq5+B1e/g6vfwdXv4Op3cPU7uPodXP0Orn4AAACAbwE4VAMAtqZkSgAAAABJRU5ErkJggg==');
            background-size: 300px;
        }
        .message {
            margin: 4px 0;
            padding: 5px 6px 6px 7px;
            border-radius: 6px;
            max-width: 70%;
            word-wrap: break-word;
            position: relative;
            transition: background-color 0.3s, color 0.3s;
            font-size: 10px;
        }
        .message.sent {
            margin-left: auto;
        }
        .dark .message.sent {
            background-color: #005c4b;
            color: #e9edef;
        }
        .light .message.sent {
            background-color: #d9fdd3;
            color: #111b21;
        }
        .dark .message.received {
            background-color: #202c33;
            color: #e9edef;
        }
        .light .message.received {
            background-color: #fff;
            color: #111b21;
        }
        .message-time {
            font-size: 7px;
            color: #667781;
            float: right;
            margin-left: 6px;
            margin-top: 2px;
        }
        .input-container {
            padding: 6px 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            border-left: 1px solid;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .dark .input-container {
            background-color: #202c33;
            border-left-color: #2a3942;
        }
        .light .input-container {
            background-color: #f0f2f5;
            border-left-color: #e9edef;
        }
        .input-icon {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: background 0.2s, color 0.3s;
        }
        .dark .input-icon {
            color: #aebac1;
        }
        .light .input-icon {
            color: #54656f;
        }
        .dark .input-icon:hover {
            background-color: #2a3942;
        }
        .light .input-icon:hover {
            background-color: #e9edef;
        }
        .input-wrapper {
            flex: 1;
            border-radius: 6px;
            display: flex;
            align-items: center;
            padding: 6px 10px;
            transition: background-color 0.3s;
        }
        .dark .input-wrapper {
            background-color: #2a3942;
        }
        .light .input-wrapper {
            background-color: #fff;
        }
        .input {
            flex: 1;
            background: none;
            border: none;
            font-size: 10px;
            outline: none;
            transition: color 0.3s;
        }
        .dark .input {
            color: #e9edef;
        }
        .light .input {
            color: #3b4a54;
        }
        .dark .input::placeholder {
            color: #667781;
        }
        .light .input::placeholder {
            color: #667781;
        }
        .send-btn {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: background 0.2s, color 0.3s;
        }
        .dark .send-btn {
            color: #aebac1;
        }
        .light .send-btn {
            color: #54656f;
        }
        .dark .send-btn:hover {
            background-color: #2a3942;
        }
        .light .send-btn:hover {
            background-color: #e9edef;
        }
        .virtual-keyboard {
            display: none;
            position: absolute;
            bottom: 60px;
            left: 20px;
            right: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            padding: 10px;
            flex-wrap: wrap;
            gap: 5px;
            z-index: 1000;
        }
        .dark .virtual-keyboard {
            background-color: #202c33;
        }
        .light .virtual-keyboard {
            background-color: #fff;
        }
        .keyboard-option {
            padding: 8px 12px;
            background-color: #e9edef;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .dark .keyboard-option {
            background-color: #2a3942;
            color: #e9edef;
        }
        .light .keyboard-option {
            background-color: #e9edef;
            color: #111b21;
        }
        .dark .keyboard-option:hover {
            background-color: #374952;
        }
        .light .keyboard-option:hover {
            background-color: #d8d9db;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .modal {
            border-radius: 8px;
            padding: 16px;
            width: 220px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            transition: background-color 0.3s;
        }
        .dark .modal {
            background-color: #202c33;
        }
        .light .modal {
            background-color: #fff;
        }
        .modal-header {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 12px;
            transition: color 0.3s;
        }
        .dark .modal-header {
            color: #e9edef;
        }
        .light .modal-header {
            color: #111b21;
        }
        .modal-input {
            width: 100%;
            padding: 8px 10px;
            margin-bottom: 8px;
            border: none;
            border-radius: 6px;
            font-size: 10px;
            outline: none;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark .modal-input {
            background-color: #2a3942;
            color: #e9edef;
        }
        .light .modal-input {
            background-color: #f0f2f5;
            color: #3b4a54;
        }
        .dark .modal-input::placeholder {
            color: #667781;
        }
        .light .modal-input::placeholder {
            color: #8696a0;
        }
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 12px;
        }
        .modal-btn {
            padding: 6px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 9px;
            font-weight: 500;
            transition: background 0.3s;
        }
        .cancel-btn {
            transition: background-color 0.3s, color 0.3s;
        }
        .dark .cancel-btn {
            background-color: #2a3942;
            color: #e9edef;
        }
        .light .cancel-btn {
            background-color: #f0f2f5;
            color: #111b21;
        }
        .dark .cancel-btn:hover {
            background-color: #374952;
        }
        .light .cancel-btn:hover {
            background-color: #e9edef;
        }
        .confirm-btn {
            background-color: #00a884;
            color: #fff;
        }
        .confirm-btn:hover {
            background-color: #06cf9c;
        }
        ::-webkit-scrollbar {
            width: 4px;
        }
        ::-webkit-scrollbar-track {
            transition: background 0.3s;
        }
        .dark ::-webkit-scrollbar-track {
            background: #111b21;
        }
        .light ::-webkit-scrollbar-track {
            background: #f0f2f5;
        }
        ::-webkit-scrollbar-thumb {
            border-radius: 10px;
            transition: background 0.3s;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #374952;
        }
        .light ::-webkit-scrollbar-thumb {
            background: #c4cbd1;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #465a64;
        }
        .light ::-webkit-scrollbar-thumb:hover {
            background: #a8b3ba;
        }
        .contact-info-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fff;
            z-index: 50;
            display: none;
            flex-direction: column;
        }
        .dark .contact-info-panel {
            background-color: #111b21;
        }
        .contact-info-panel.show {
            display: flex;
        }
        .info-header {
            padding: 6px 10px;
            display: flex;
            align-items: center;
            height: 35px;
            border-bottom: 1px solid;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .dark .info-header {
            background-color: #202c33;
            border-bottom-color: #2a3942;
        }
        .light .info-header {
            background-color: #008069;
            border-bottom-color: #e9edef;
        }
        .close-info-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
            margin-right: 10px;
            transition: color 0.3s;
        }
        .dark .close-info-btn {
            color: #aebac1;
        }
        .light .close-info-btn {
            color: #fff;
        }
        .info-header-title {
            font-size: 12px;
            font-weight: 500;
        }
        .dark .info-header-title {
            color: #e9edef;
        }
        .light .info-header-title {
            color: #fff;
        }
        .info-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }
        .info-avatar-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid;
        }
        .dark .info-avatar-section {
            border-bottom-color: #2a3942;
        }
        .light .info-avatar-section {
            border-bottom-color: #e9edef;
        }
        .info-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin-bottom: 10px;
            transition: background-color 0.3s;
        }
        .dark .info-avatar {
            background-color: #6b7c85;
        }
        .light .info-avatar {
            background-color: #dfe5e7;
        }
        .info-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            transition: color 0.3s;
        }
        .dark .info-name {
            color: #e9edef;
        }
        .light .info-name {
            color: #111b21;
        }
        .info-phone {
            font-size: 10px;
            color: #667781;
        }
        .info-section {
            padding: 12px 0;
            border-bottom: 1px solid;
        }
        .dark .info-section {
            border-bottom-color: #2a3942;
        }
        .light .info-section {
            border-bottom-color: #e9edef;
        }
        .info-section-title {
            font-size: 9px;
            color: #00a884;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .info-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .info-option:hover {
            opacity: 0.7;
        }
        .info-option-icon {
            font-size: 18px;
            width: 24px;
        }
        .info-option-text {
            flex: 1;
        }
        .info-option-label {
            font-size: 11px;
            transition: color 0.3s;
        }
        .dark .info-option-label {
            color: #e9edef;
        }
        .light .info-option-label {
            color: #111b21;
        }
        .info-option-detail {
            font-size: 9px;
            color: #667781;
        }
        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            padding: 12px 0;
        }
        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .dark .action-btn {
            background-color: #202c33;
            color: #aebac1;
        }
        .light .action-btn {
            background-color: #f0f2f5;
            color: #54656f;
        }
        .action-btn-icon {
            font-size: 20px;
        }
        .action-btn-label {
            font-size: 8px;
        }
        .settings-menu {
            position: absolute;
            top: 40px;
            left: 8px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 100;
            min-width: 160px;
            display: none;
        }
        .dark .settings-menu {
            background-color: #233138;
        }
        .settings-menu.show {
            display: block;
        }
        .settings-item {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 11px;
            border-bottom: 1px solid;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .dark .settings-item {
            color: #e9edef;
            border-bottom-color: #2a3942;
        }
        .light .settings-item {
            color: #3b4a54;
            border-bottom-color: #e9edef;
        }
        .settings-item:last-child {
            border-bottom: none;
        }
        .dark .settings-item:hover {
            background-color: #2a3942;
        }
        .light .settings-item:hover {
            background-color: #f5f6f6;
        }
        .settings-icon {
            font-size: 14px;
        }
    </style>
</head>
<body class="light">
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Chats</div>
            <div class="header-icons">
                <button class="header-icon" onclick="showAddContact()">+</button>
                <button class="header-icon" onclick="toggleMenu()">⋮</button>
            </div>
        </div>
        <div class="settings-menu" id="settingsMenu">
            <div class="settings-item" onclick="toggleTheme()">
                <span class="settings-icon" id="themeIcon">🌙</span>
                <span>Tema oscuro</span>
            </div>
            <div class="settings-item" onclick="alert('Notificaciones activadas')">
                <span class="settings-icon">🔔</span>
                <span>Notificaciones</span>
            </div>
            <div class="settings-item" onclick="alert('Archivados: 0 chats')">
                <span class="settings-icon">📦</span>
                <span>Archivados</span>
            </div>
            <div class="settings-item" onclick="alert('Destacados')">
                <span class="settings-icon">⭐</span>
                <span>Destacados</span>
            </div>
            <div class="settings-item" onclick="alert('Ajustes de FruitCall')">
                <span class="settings-icon">⚙️</span>
                <span>Ajustes</span>
            </div>
        </div>
        <div class="search-container">
            <input type="text" class="search-box" id="searchBox" placeholder="Buscar chat" oninput="searchChats()">
        </div>
        <div class="contacts-list" id="contacts-list">
            <div class="contact active" onclick="selectChat('Granjero','🌾')" data-contact="Granjero">
                <div class="contact-avatar">🌾</div>
                <div class="contact-info">
                    <div class="contact-header">
                        <div class="contact-name">Granjero</div>
                        <div class="contact-time">08:48</div>
                    </div>
                    <div class="contact-message">Hola Bowl</div>
                </div>
            </div>
            <div class="contact" onclick="selectChat('Hermano del Granjero','🌱')" data-contact="Hermano del Granjero">
                <div class="contact-avatar">🌱</div>
                <div class="contact-info">
                    <div class="contact-header">
                        <div class="contact-name">Hermano del Granjero</div>
                        <div class="contact-time">08:47</div>
                    </div>
                    <div class="contact-message">Hola, ¿Sucede algo?</div>
                </div>
            </div>
            <div class="contact" onclick="selectChat('Dios de las manzanas','🍎')" data-contact="Dios de las manzanas">
                <div class="contact-avatar">🍎</div>
                <div class="contact-info">
                    <div class="contact-header">
                        <div class="contact-name">Dios de las manzanas</div>
                        <div class="contact-time">08:46</div>
                    </div>
                    <div class="contact-message">(NADA)</div>
                </div>
            </div>
        </div>
    </div>
    <div class="chat-section">
        <div class="chat-header">
            <div class="chat-header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">☰</button>
                <div class="chat-header-avatar" id="chatHeaderAvatar" onclick="showContactInfo()">🌾</div>
                <div class="chat-header-info" onclick="showContactInfo()" style="cursor:pointer;">
                    <div class="chat-header-name" id="chatHeaderName">Granjero</div>
                    <div class="chat-header-status">en línea</div>
                </div>
            </div>
            <button class="theme-toggle">⋮</button>
        </div>
        <div id="chat-Granjero" class="chat-container">
            <div class="message received">Hola Bowl 🌾<span class="message-time">08:48</span></div>
        </div>
        <div id="chat-Hermano del Granjero" class="chat-container" style="display:none;">
            <div class="message received">Hola, ¿Sucede algo? 🌱<span class="message-time">08:47</span></div>
        </div>
        <div id="chat-Dios de las manzanas" class="chat-container" style="display:none;">
            <div class="message received">(NADA) 🍎<span class="message-time">08:46</span></div>
        </div>
        <div class="input-container">
            <button class="input-icon">😊</button>
            <button class="input-icon">+</button>
            <div class="input-wrapper">
                <input type="text" id="messageInput" class="input" placeholder="Escribe un mensaje" onclick="showVirtualKeyboard()">
            </div>
            <button class="send-btn" onclick="sendMessage()">➤</button>
        </div>
        <div id="virtualKeyboard" class="virtual-keyboard"></div>
    </div>
    <div class="contact-info-panel" id="contactInfoPanel">
        <div class="info-header">
            <button class="close-info-btn" onclick="closeContactInfo()">✕</button>
            <div class="info-header-title">Info. del contacto</div>
        </div>
        <div class="info-content">
            <div class="info-avatar-section">
                <div class="info-avatar" id="infoAvatar">🌾</div>
                <div class="info-name" id="infoName">Granjero</div>
                <div class="info-phone" id="infoPhone">+51 934 567 890</div>
            </div>
            <div class="action-buttons">
                <button class="action-btn" onclick="alert('Llamada de audio')">
                    <div class="action-btn-icon">📞</div>
                    <div class="action-btn-label">Audio</div>
                </button>
                <button class="action-btn" onclick="alert('Videollamada')">
                    <div class="action-btn-icon">📹</div>
                    <div class="action-btn-label">Video</div>
                </button>
                <button class="action-btn" onclick="alert('Buscar en chat')">
                    <div class="action-btn-icon">🔍</div>
                    <div class="action-btn-label">Buscar</div>
                </button>
            </div>
            <div class="info-section">
                <div class="info-section-title">Contacto</div>
                <div class="info-option" onclick="editContactName()">
                    <div class="info-option-icon">✏️</div>
                    <div class="info-option-text">
                        <div class="info-option-label">Cambiar nombre</div>
                        <div class="info-option-detail">Editar nombre del contacto</div>
                    </div>
                </div>
                <div class="info-option" onclick="viewContactNumber()">
                    <div class="info-option-icon">📱</div>
                    <div class="info-option-text">
                        <div class="info-option-label" id="displayPhone">+51 934 567 890</div>
                        <div class="info-option-detail">Número de teléfono</div>
                    </div>
                </div>
            </div>
            <div class="info-section">
                <div class="info-section-title">Más opciones</div>
                <div class="info-option" onclick="alert('Silenciar notificaciones')">
                    <div class="info-option-icon">🔕</div>
                    <div class="info-option-text">
                        <div class="info-option-label">Silenciar</div>
                    </div>
                </div>
                <div class="info-option" onclick="alert('Bloquear contacto')">
                    <div class="info-option-icon">🚫</div>
                    <div class="info-option-text">
                        <div class="info-option-label">Bloquear</div>
                    </div>
                </div>
                <div class="info-option" onclick="deleteContact()" style="color:#ff4444;">
                    <div class="info-option-icon">🗑️</div>
                    <div class="info-option-text">
                        <div class="info-option-label" style="color:#ff4444;">Eliminar contacto</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="addContactModal" class="modal-overlay" style="display:none;" onclick="hideAddContactOnOutsideClick(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">Agregar contacto</div>
            <input type="text" id="contactName" class="modal-input" placeholder="Nombre del contacto">
            <input type="text" id="contactNumber" class="modal-input" placeholder="Número de teléfono">
            <div class="modal-buttons">
                <button class="modal-btn cancel-btn" onclick="hideAddContact()">Cancelar</button>
                <button class="modal-btn confirm-btn" onclick="addNewContact()">Agregar</button>
            </div>
        </div>
    </div>
    <script>
        let currentChat = 'Granjero';
        let currentEmoji = '🌾';
        let contactCounter = 0;
        let isDark = false;
        let sidebarVisible = true;
        let contactsData = {
            'Granjero': { emoji: '🌾', phone: '+51 934 567 890' },
            'Hermano del Granjero': { emoji: '🌱', phone: '+51 723 981 045' },
            'Dios de las manzanas': { emoji: '🍎', phone: '+51 456 789 123' }
        };

        const predefQuestions = [
            '¿Cómo va tu día en la granja?',
            '¿Necesitas ayuda con algo hoy?',
            '¿Qué tal el clima para las manzanas?',
            '¿Has creado algo nuevo con IA?',
            '¿Dónde está tu hermano?',
            '¿Crees en el Dios de las manzanas?',
            '¿Qué receta nueva probaste?'
        ];

        const predefResponses = {
            'Granjero': [
                '¡Todo bien en la granja, Bowl! 🌾',
                'Estoy cultivando un nuevo huerto con IA, ¡genial, no? 🎉',
                'Mi hermano anda por ahí, seguro tímido como siempre. 🌱',
                'El clima está perfecto para manzanas, ¡un éxito! 🍎'
            ],
            'Hermano del Granjero': [
                'Eh... hola, solo pasaba por aquí... 🌱',
                'No sé mucho, pero puedo ayudarte si quieres... 😅',
                'Mi hermano siempre está ocupado con esa IA...',
                '¿Crees que el Dios de las manzanas me verá? 🍎'
            ],
            'Dios de las manzanas': [
                '(NADA)'
            ]
        };

        const initialMessages = {
            'Granjero': ['Hola Bowl 🌾', '¡Oye Bowl, hoy es un gran día! 🌾', 'Bowl, ¿listo para la cosecha? 🌾'],
            'Hermano del Granjero': ['Hola, ¿Sucede algo? 🌱', 'Eh... ¿necesitas algo, Bowl? 🌱', 'Hola, estoy un poco nervioso... 🌱'],
            'Dios de las manzanas': ['(NADA) 🍎']
        };

        function toggleMenu() {
            let menu = document.getElementById('settingsMenu');
            menu.classList.toggle('show');
        }

        function toggleSidebar() {
            sidebarVisible = !sidebarVisible;
            document.getElementById('sidebar').classList.toggle('hidden');
        }

        function toggleTheme() {
            isDark = !isDark;
            document.body.className = isDark ? 'dark' : 'light';
            document.getElementById('themeIcon').textContent = isDark ? '☀️' : '🌙';
            document.querySelector('.settings-item span:nth-child(2)').textContent = isDark ? 'Tema claro' : 'Tema oscuro';
            let menu = document.getElementById('settingsMenu');
            menu.classList.remove('show');
        }

        function searchChats() {
            let searchValue = document.getElementById('searchBox').value.toLowerCase();
            let contacts = document.querySelectorAll('.contact');
            contacts.forEach(contact => {
                let name = contact.querySelector('.contact-name').textContent.toLowerCase();
                if (name.includes(searchValue)) {
                    contact.style.display = 'flex';
                } else {
                    contact.style.display = 'none';
                }
            });
        }

        function showContactInfo() {
            document.getElementById('contactInfoPanel').classList.add('show');
            document.getElementById('infoName').textContent = currentChat;
            document.getElementById('infoAvatar').textContent = currentEmoji;
            let phone = contactsData[currentChat] ? contactsData[currentChat].phone : '+51 000 000 000';
            document.getElementById('infoPhone').textContent = phone;
            document.getElementById('displayPhone').textContent = phone;
        }

        function closeContactInfo() {
            document.getElementById('contactInfoPanel').classList.remove('show');
        }

        function editContactName() {
            let newName = prompt('Ingresa el nuevo nombre:', currentChat);
            if (newName && newName.trim() !== '') {
                let oldName = currentChat;
                contactsData[newName] = contactsData[oldName];
                delete contactsData[oldName];
                let contact = document.querySelector(`.contact[data-contact="${oldName}"]`);
                contact.setAttribute('data-contact', newName);
                contact.setAttribute('onclick', `selectChat('${newName}','${currentEmoji}')`);
                contact.querySelector('.contact-name').textContent = newName;
                let chatContainer = document.getElementById(`chat-${oldName}`);
                chatContainer.id = `chat-${newName}`;
                currentChat = newName;
                document.getElementById('chatHeaderName').textContent = newName;
                document.getElementById('infoName').textContent = newName;
            }
        }

        function viewContactNumber() {
            let phone = contactsData[currentChat] ? contactsData[currentChat].phone : '+51 000 000 000';
            alert('Número de teléfono: ' + phone);
        }

        function deleteContact() {
            if (confirm('¿Eliminar este contacto?')) {
                let contact = document.querySelector(`.contact[data-contact="${currentChat}"]`);
                let chatContainer = document.getElementById(`chat-${currentChat}`);
                if (contact) contact.remove();
                if (chatContainer) chatContainer.remove();
                delete contactsData[currentChat];
                closeContactInfo();
                let firstContact = document.querySelector('.contact');
                if (firstContact) {
                    firstContact.click();
                }
            }
        }

        function selectChat(contact, emoji) {
            document.querySelectorAll('.contact').forEach(c => c.classList.remove('active'));
            document.querySelector(`.contact[data-contact="${contact}"]`).classList.add('active');
            document.querySelectorAll('.chat-container').forEach(c => c.style.display = 'none');
            let chatEl = document.getElementById(`chat-${contact}`);
            if (chatEl) {
                chatEl.style.display = 'block';
                currentChat = contact;
                currentEmoji = emoji;
                document.getElementById('chatHeaderName').textContent = contact;
                document.getElementById('chatHeaderAvatar').textContent = emoji;
                chatEl.scrollTop = chatEl.scrollHeight;
            }
            if (window.innerWidth < 600) {
                toggleSidebar();
            }
            let menu = document.getElementById('settingsMenu');
            menu.classList.remove('show');
            closeContactInfo();
        }

        function showVirtualKeyboard() {
            let keyboard = document.getElementById('virtualKeyboard');
            keyboard.innerHTML = '';
            let options = [...predefQuestions];
            if (currentChat !== 'Dios de las manzanas') {
                options.push(...predefResponses[currentChat].map(r => `Responder: ${r}`));
            }
            options = shuffle(options);
            options.slice(0, 5).forEach(option => {
                let button = document.createElement('div');
                button.className = 'keyboard-option';
                button.textContent = option;
                button.onclick = () => sendPredefMessage(option);
                keyboard.appendChild(button);
            });
            keyboard.style.display = 'flex';
        }

        function hideVirtualKeyboard() {
            document.getElementById('virtualKeyboard').style.display = 'none';
        }

        function sendPredefMessage(option) {
            let chat = document.getElementById('chat-' + currentChat);
            let message = option.replace('Responder: ', '');
            let now = new Date();
            let time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            let newMessage = document.createElement('div');
            newMessage.classList.add('message', 'sent');
            newMessage.innerHTML = message + ' 🍎<span class="message-time">' + time + '</span>';
            chat.appendChild(newMessage);
            chat.scrollTop = chat.scrollHeight;
            hideVirtualKeyboard();

            if (currentChat !== 'Dios de las manzanas') {
                setTimeout(() => {
                    let response = getRandomResponse();
                    let receivedMessage = document.createElement('div');
                    receivedMessage.classList.add('message', 'received');
                    receivedMessage.innerHTML = response + ' ' + currentEmoji + '<span class="message-time">' + time + '</span>';
                    chat.appendChild(receivedMessage);
                    chat.scrollTop = chat.scrollHeight;
                }, 2000);
            }
        }

        function getRandomResponse() {
            let context = document.querySelectorAll('#chat-' + currentChat + ' .message.sent');
            let lastSent = context.length > 0 ? context[context.length - 1].textContent : '';
            let validResponses = predefResponses[currentChat].filter(r => {
                if (!lastSent) return true;
                return r.toLowerCase().includes(lastSent.toLowerCase().replace('¿', '').replace('?', ''));
            });
            return validResponses.length > 0 ? validResponses[Math.floor(Math.random() * validResponses.length)] : predefResponses[currentChat][Math.floor(Math.random() * predefResponses[currentChat].length)];
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function showAddContact() {
            document.getElementById('addContactModal').style.display = 'flex';
            document.getElementById('contactName').value = '';
            document.getElementById('contactNumber').value = '';
        }

        function hideAddContact() {
            document.getElementById('addContactModal').style.display = 'none';
        }

        function hideAddContactOnOutsideClick(event) {
            if (event.target.id === 'addContactModal') {
                hideAddContact();
            }
        }

        function addNewContact() {
            let name = document.getElementById('contactName').value.trim();
            let number = document.getElementById('contactNumber').value.trim();
            if (name === '' || number === '') {
                alert('Por favor ingresa nombre y número');
                return;
            }
            if (contactsData[name]) {
                alert('Este contacto ya existe');
                return;
            }
            contactsData[name] = { phone: number, emoji: contactCounter % 2 === 0 ? '🍎' : '🍏' };
            let contactsList = document.getElementById('contacts-list');
            let newContact = document.createElement('div');
            newContact.classList.add('contact');
            newContact.setAttribute('data-contact', name);
            let emoji = contactCounter % 2 === 0 ? '🍎' : '🍏';
            contactCounter++;
            newContact.setAttribute('onclick', `selectChat('${name}','${emoji}')`);
            newContact.innerHTML = `<div class="contact-avatar">${emoji}</div><div class="contact-info"><div class="contact-header"><div class="contact-name">${name}</div><div class="contact-time">Ahora</div></div><div class="contact-message">${number}</div></div>`;
            contactsList.appendChild(newContact);
            let chatSection = document.querySelector('.chat-section');
            let newChatContainer = document.createElement('div');
            newChatContainer.id = `chat-${name}`;
            newChatContainer.classList.add('chat-container');
            newChatContainer.style.display = 'none';
            newChatContainer.innerHTML = `<div class="message received">¡Hola! Soy ${name} 🍏<span class="message-time">Ahora</span></div>`;
            chatSection.insertBefore(newChatContainer, document.querySelector('.input-container'));
            hideAddContact();
        }

        // Initial chat messages
        document.querySelectorAll('.chat-container').forEach(chat => {
            let contact = chat.id.replace('chat-', '');
            let initialMsg = initialMessages[contact][Math.floor(Math.random() * initialMessages[contact].length)];
            let now = new Date();
            let time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            chat.innerHTML = `<div class="message received">${initialMsg}<span class="message-time">${time}</span></div>`;
        });

        document.getElementById('chat-Granjero').style.display = 'block';
    </script>
</body>
</html>
